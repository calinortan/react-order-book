(this["webpackJsonporder-book"]=this["webpackJsonporder-book"]||[]).push([[0],{21:function(e,t,n){},45:function(e,t,n){},46:function(e,t,n){},47:function(e,t,n){},48:function(e,t,n){},49:function(e,t,n){},50:function(e,t,n){"use strict";n.r(t);var s,r=n(1),c=n.n(r),o=n(10),a=n.n(o),i=(n(21),n.p+"static/media/logo.6ce24c58.svg"),d=n(8),l=n(11),u=n.n(l),b=n(7),j=n(4),O=n(12),h=n(13),m=n(16),v=n(14),f=n(3),k=n(0),p="wss://www.cryptofacilities.com/ws/v1",N='{"event":"subscribe","feed":"book_ui_1","product_ids":["PI_XBTUSD"]}',g={bids:{},asks:{},connecting:!0,error:""},x=Object(r.createContext)(g),w=200,A=function(e){Object(m.a)(n,e);var t=Object(v.a)(n);function n(){var e;Object(O.a)(this,n);for(var s=arguments.length,r=new Array(s),c=0;c<s;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).wsConnection=new WebSocket(p),e.latestBids={},e.latestAsks={},e.state=g,e.setBids=function(t){e.setState({bids:t})},e.setAsks=function(t){e.setState({asks:t})},e.throttledSetBids=Object(f.throttle)(e.setBids,w),e.throttledSetAsks=Object(f.throttle)(e.setAsks,w),e.setNewBids=function(t){e.latestBids=t,e.throttledSetBids(e.latestBids)},e.setNewAsks=function(t){e.latestAsks=t,e.throttledSetAsks(e.latestAsks)},e.createNewOrders=function(e,t){return e.reduce((function(e,t){var n=Object(d.a)(t,2),s=n[0],r=n[1];return 0===r&&delete e[s],r>0&&(e[s]=r),e}),Object(j.a)({},t))},e.handleNewBids=function(t){var n=e.createNewOrders(t,e.latestBids);e.setNewBids(n)},e.handleNewAsks=function(t){var n=e.createNewOrders(t,e.latestAsks);e.setNewAsks(n)},e.handleWsOpen=function(t){e.setState({connecting:!1}),e.wsConnection.send(N),e.wsConnection.onmessage=function(t){try{var n,s,r=JSON.parse(t.data);e.handleNewBids(null!==(n=null===r||void 0===r?void 0:r.bids)&&void 0!==n?n:[]),e.handleNewAsks(null!==(s=null===r||void 0===r?void 0:r.asks)&&void 0!==s?s:[])}catch(c){e.setState({error:c.message})}}},e.handleWsError=function(t){e.setState({error:"Connection failed",connecting:!1})},e}return Object(h.a)(n,[{key:"componentDidMount",value:function(){this.wsConnection.onopen=this.handleWsOpen,this.wsConnection.onerror=this.handleWsError}},{key:"componentWillUnmount",value:function(){this.throttledSetBids.cancel()}},{key:"render",value:function(){var e=this.props.children;return Object(k.jsx)(x.Provider,{value:this.state,children:e})}}]),n}(c.a.Component),C=A,B=n(15),S=(n(45),Object(r.memo)((function(e){var t=e.price,n=e.size,s=e.total,r=e.ratio,c=void 0===r?0:r,o=e.ratioColor,a=void 0===o?"green":o;return Object(k.jsxs)("div",{className:"OrderItem",children:[Object(k.jsx)("div",{className:"OrderItem_Ratio",style:{width:"".concat(c,"%"),backgroundColor:a}}),Object(k.jsx)("div",{className:"OrderItem_Column",children:t.toLocaleString()}),Object(k.jsx)("div",{className:"OrderItem_Column",children:n.toLocaleString()}),Object(k.jsx)("div",{className:"OrderItem_Column",children:s.toLocaleString()})]})})));n(46);!function(e){e.Bid="Bid",e.Ask="Ask"}(s||(s={}));var y=Object(r.memo)((function(e){var t=e.type,n=e.orders,c=Object(r.useMemo)((function(){var e=Object.keys(n).sort((function(e,t){return Number(t)-Number(e)}));return(t===s.Ask?f.drop:f.dropRight)(e,e.length-15)}),[t,n]),o=Object(r.useMemo)((function(){var e=t===s.Ask?Object(B.a)(c).reverse():c;return Object(f.reduce)(e,(function(e,t,s,r){var c=Number(r[Number(s)-1]),o=e.get(c)||0;return e.set(Number(t),o+n[Number(t)]),e}),new Map)}),[t,c,n]);return Object(k.jsx)("div",{className:"OrderGrid",children:c.map((function(e){var r=Number(e),a=o.get(r)||0,i=t===s.Ask?f.first:f.last,d=o.get(Number(i(c))),l=t===s.Ask?"red":"green";return Object(k.jsx)(S,{price:r,size:n[r],total:a,ratio:100*a/d,ratioColor:l},e)}))})})),M=(n(47),function(e){var t=e.spread,n=e.group,s=e.handleIncrease,r=e.handleDecrease,c=e.increaseDisabled,o=e.decreaseDisabled;return Object(f.isNaN)(t)||Object(f.isNil)(t)?null:Object(k.jsxs)("div",{className:"OrderBookActions",children:[Object(k.jsx)("div",{children:"Spread: ".concat(t)}),Object(k.jsx)("div",{children:"Group: ".concat(n)}),Object(k.jsxs)("div",{children:[Object(k.jsx)("button",{className:"OrderBookActions_GroupChanger",onClick:s,disabled:c,children:"+"}),Object(k.jsx)("button",{className:"OrderBookActions_GroupChanger",onClick:r,disabled:o,children:"-"})]})]})}),D=(n(48),[.5,1,5,10,25,50]),I=function(){var e=Object(r.useState)(0),t=Object(d.a)(e,2),n=t[0],c=t[1],o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.5,t=Object(r.useContext)(x),n=Object(r.useMemo)((function(){var e=Number(Object(f.min)(Object(f.keys)(t.asks))),n=Number(Object(f.max)(Object(f.keys)(t.bids)));return Math.abs(e-n)}),[t.asks,t.bids]),s=Object(r.useCallback)((function(t){return Object(f.keys)(t).reduce((function(n,s){var r=Math.floor(Number(s)/e)*e;null==n[r]&&(n[r]=0);var c=n[r]+t[Number(s)];return Object(j.a)(Object(j.a)({},n),{},Object(b.a)({},r,c))}),{})}),[e]),c=Object(r.useMemo)((function(){return e<1?t.bids:s(t.bids)}),[t.bids,e,s]),o=Object(r.useMemo)((function(){return e?s(t.asks):t.asks}),[t.asks,e,s]);return Object(j.a)(Object(j.a)({},t),{},{bids:c,asks:o,spread:n})}(D[n]),a=o.bids,i=o.asks,l=o.spread,O=o.connecting,h=o.error,m=function(){n<D.length-1&&c(n+1)},v=function(){n>0&&c(n-1)};return Object(k.jsx)("div",{className:"OrderBook",children:h?Object(k.jsx)("span",{children:h}):O?Object(k.jsx)(u.a,{type:"MutatingDots",color:"teal",secondaryColor:"teal"}):Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)(y,{type:s.Ask,orders:i}),Object(k.jsx)(M,{spread:l,group:D[n],handleDecrease:v,decreaseDisabled:0===n,handleIncrease:m,increaseDisabled:n===D.length-1}),Object(k.jsx)(y,{type:s.Bid,orders:a})]})})};n(49);var _=function(){return Object(k.jsxs)("div",{className:"App",children:[Object(k.jsxs)("header",{className:"App-header",children:[Object(k.jsx)("img",{src:i,className:"App-logo",alt:"logo"}),Object(k.jsx)("h4",{children:"Calin's Order Book"})]}),Object(k.jsx)("div",{className:"App-container",children:Object(k.jsx)(C,{children:Object(k.jsx)(I,{})})})]})},W=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,51)).then((function(t){var n=t.getCLS,s=t.getFID,r=t.getFCP,c=t.getLCP,o=t.getTTFB;n(e),s(e),r(e),c(e),o(e)}))};a.a.render(Object(k.jsx)(c.a.StrictMode,{children:Object(k.jsx)(_,{})}),document.getElementById("root")),W()}},[[50,1,2]]]);
//# sourceMappingURL=main.e2c955fa.chunk.js.map